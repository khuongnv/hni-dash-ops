import{defineComponent as e,shallowRef as t,getCurrentInstance as l,provide as r,cloneVNode as n,h as a,createElementBlock as s,ref as o,mergeProps as i,computed as c,withCtx as u,unref as d,createVNode as m,resolveDynamicComponent as p,createBlock as v,openBlock as f,watch as g,resolveComponent as h,createCommentVNode as x,Transition as b,useSSRContext as y}from"vue";import{ssrRenderAttrs as w,ssrRenderComponent as $,ssrRenderClass as _,ssrRenderSlot as k,ssrRenderVNode as I,ssrRenderAttr as S,ssrRenderList as j,ssrInterpolate as C,ssrRenderStyle as A}from"vue/server-renderer";import{useRoute as H}from"vue-router";import{_ as T}from"./nuxt-link-DTyZRdIe.mjs";import{S as L,M,X as N,C as q}from"./x-DhLUtfnd.mjs";import{u as z}from"./useAuth-UVHtf-eW.mjs";import{u as Q,a as D}from"./useIcons-CU1xCIuG.mjs";import{S as B}from"./search-CDjPCz-A.mjs";import{_ as P,a as R,c as O}from"./server.mjs";import{_ as U}from"./Button-C4ZWmsC_.mjs";import{M as F}from"./menu-C-lPDpZQ.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"./createLucideIcon-DpBqMQLu.mjs";import"./useErrorHandler-y_M1hPJN.mjs";import"./useAPI-Bps8bvAQ.mjs";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"unhead/plugins";import"class-variance-authority";import"./utils-H80jjgLf.mjs";import"clsx";import"tailwind-merge";e({name:"ServerPlaceholder",render:()=>s("div")});const E=Symbol.for("nuxt:client-only"),Z=e({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(e,{slots:o,attrs:i}){const c=t(!1),u=l();return u&&(u._nuxtClientOnly=!0),r(E,!0),()=>{var t;if(c.value){const e=null==(t=o.default)?void 0:t.call(o);return e&&1===e.length?[n(e[0],i)]:e}const l=o.fallback||o.placeholder;if(l)return a(l);const r=e.fallback||e.placeholder||"",u=e.fallbackTag||e.placeholderTag||"span";return s(u,i,r)}}}),G=e({__name:"Tooltip",__ssrInlineRender:!0,props:{content:{},placement:{default:"right"},delay:{default:0},disabled:{type:Boolean,default:!1}},setup(e){const t=e,l=o(!1);o(),o();const r=o({}),n=c(()=>{const e="pointer-events-none";switch(t.placement){case"top":return`${e} bottom-full left-1/2 transform -translate-x-1/2 mb-2`;case"bottom":return`${e} top-full left-1/2 transform -translate-x-1/2 mt-2`;case"left":return`${e} right-full top-1/2 transform -translate-y-1/2 mr-2`;case"right":return`${e} left-full top-1/2 transform -translate-y-1/2 ml-2`;default:return e}}),a=c(()=>{switch(t.placement){case"top":return"top-full left-1/2 transform -translate-x-1/2 border-t-popover";case"bottom":return"bottom-full left-1/2 transform -translate-x-1/2 border-b-popover";case"left":return"left-full top-1/2 transform -translate-y-1/2 border-l-popover";case"right":return"right-full top-1/2 transform -translate-y-1/2 border-r-popover";default:return""}});return(e,t,s,o)=>{t(`<div${w(i({class:"relative inline-block"},o))}><div>`),k(e.$slots,"default",{},null,t,s),t("</div>"),d(l)?t(`<div role="tooltip"${S("aria-hidden",!d(l))} class="${_([d(n),"absolute z-50 px-2 py-1 text-xs text-popover-foreground bg-popover rounded-md shadow-lg whitespace-nowrap"])}" style="${A(d(r))}">${C(e.content)} <div class="${_([d(a),"absolute w-0 h-0 border-4 border-transparent"])}"></div></div>`):t("\x3c!----\x3e"),t("</div>")}}}),J=G.setup;G.setup=(e,t)=>{const l=y();return(l.modules||(l.modules=new Set)).add("components/ui/Tooltip.vue"),J?J(e,t):void 0};const V=e({__name:"HighlightText",__ssrInlineRender:!0,props:{text:{},query:{}},setup(e){const t=e,removeDiacritics=e=>{let t=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t=t.replace(/[đĐ]/g,"d").replace(/[ăĂ]/g,"a").replace(/[âÂ]/g,"a").replace(/[êÊ]/g,"e").replace(/[ôÔ]/g,"o").replace(/[ơƠ]/g,"o").replace(/[ưƯ]/g,"u"),t},l=c(()=>{if(!t.query.trim())return t.text;const e=removeDiacritics(t.query);if(!removeDiacritics(t.text).toLowerCase().includes(e.toLowerCase()))return t.text;const l={a:"[aàáạảãâầấậẩẫăằắặẳẵ]",e:"[eèéẹẻẽêềếệểễ]",i:"[iìíịỉĩ]",o:"[oòóọỏõôồốộổỗơờớợởỡ]",u:"[uùúụủũưừứựửữ]",y:"[yỳýỵỷỹ]",d:"[dđ]"};let r=t.query.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");for(const[e,t]of Object.entries(l))r=r.replace(new RegExp(e,"gi"),t);const n=new RegExp(`(${r})`,"gi");return t.text.replace(n,'<mark class="bg-yellow-200 text-yellow-900 px-1 rounded">$1</mark>')});return(e,t,r,n)=>{var a;t(`<span${w(n)}>${null!=(a=d(l))?a:""}</span>`)}}}),W=V.setup;V.setup=(e,t)=>{const l=y();return(l.modules||(l.modules=new Set)).add("components/ui/HighlightText.vue"),W?W(e,t):void 0};const K=e({__name:"MenuItem",__ssrInlineRender:!0,props:{item:{},level:{default:0},collapsed:{type:Boolean},openSubmenus:{},toggleSubmenu:{},isActive:{},isSubmenuActive:{},searchQuery:{default:""}},setup:e=>(e,t,l,r)=>{const n=h("MenuItem",!0),a=T;t(`<div${w(r)}>`),e.item.children&&e.item.children.length>0?(t(`<div><button${S("aria-expanded",e.openSubmenus.includes(e.item.name))}${S("aria-controls",`submenu-${e.item.name}`)}${S("aria-label",e.collapsed?e.item.name:void 0)} class="${_(["flex items-center w-full rounded-lg font-medium transition-all duration-200 relative group focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 gap-3",0===e.level?"text-sm min-h-[2.5rem]":1===e.level?"text-sm min-h-[2.25rem]":2===e.level?"text-xs min-h-[2rem]":"text-xs min-h-[1.75rem]",e.collapsed?"px-2 py-2 justify-center":0===e.level?"px-3 py-2":1===e.level?"px-3 py-1.5":(e.level,"px-2 py-1"),(e.level,""),e.isActive(e.item.href)?0===e.level?"bg-primary text-primary-foreground":"bg-primary/20 text-primary":e.isSubmenuActive(e.item.children)?0===e.level?"bg-accent/50 text-accent-foreground":"bg-accent/30 text-accent-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"])}">`),I(t,m(p(e.item.icon),{class:[0===e.level?"h-5 w-5":1===e.level?"h-4 w-4":2===e.level?"h-3.5 w-3.5":"h-3 w-3","flex-shrink-0","self-center"]},null),l),e.collapsed?t("\x3c!----\x3e"):(t('<span class="whitespace-nowrap flex-1 text-left leading-none self-center">'),t($(V,{text:e.item.name,query:e.searchQuery},null,l)),t("</span>")),e.collapsed?t("\x3c!----\x3e"):t($(d(q),{class:[0===e.level?"h-4 w-4":1===e.level?"h-3.5 w-3.5":2===e.level?"h-3 w-3":"h-2.5 w-2.5","transition-transform duration-200 self-center flex-shrink-0",{"rotate-180":e.openSubmenus.includes(e.item.name)}]},null,l)),e.collapsed?t($(G,{content:e.item.name,placement:"right",delay:300},null,l)):t("\x3c!----\x3e"),t("</button>"),e.openSubmenus.includes(e.item.name)?(t(`<div${S("id",`submenu-${e.item.name}`)} role="menu"${S("aria-label",`${e.item.name} submenu`)} class="${_(e.collapsed?"mt-1 space-y-1":`ml-${6+2*e.level} mt-1 space-y-1 border-l border-border/20 pl-2`)}">\x3c!--[--\x3e`),j(e.item.children,r=>{t($(n,{key:r.name,item:r,level:e.level+1,collapsed:e.collapsed,"open-submenus":e.openSubmenus,"toggle-submenu":e.toggleSubmenu,"is-active":e.isActive,"is-submenu-active":e.isSubmenuActive,"search-query":e.searchQuery},null,l))}),t("\x3c!--]--\x3e</div>")):t("\x3c!----\x3e"),t("</div>")):(t("<div>"),t($(a,{to:e.item.href,"aria-label":e.collapsed?e.item.name:void 0,"aria-current":e.isActive(e.item.href)?"page":void 0,class:["flex items-center w-full rounded-lg font-medium transition-all duration-200 relative group focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 gap-3",0===e.level?"text-sm min-h-[2.5rem]":1===e.level?"text-sm min-h-[2.25rem]":2===e.level?"text-xs min-h-[2rem]":"text-xs min-h-[1.75rem]",e.collapsed?"px-2 py-2 justify-center":0===e.level?"px-3 py-2":1===e.level?"px-3 py-1.5":(e.level,"px-2 py-1"),(e.level,""),e.isActive(e.item.href)?0===e.level?"bg-primary text-primary-foreground":"bg-primary/20 text-primary":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"]},{default:u((t,l,r,n)=>{if(!l)return[(f(),v(p(e.item.icon),{class:[0===e.level?"h-5 w-5":1===e.level?"h-4 w-4":2===e.level?"h-3.5 w-3.5":"h-3 w-3","flex-shrink-0","self-center"]},null,8,["class"])),m(b,{name:"fade",mode:"out-in"},{default:u(()=>[e.collapsed?x("",!0):(f(),v("span",{key:0,class:"whitespace-nowrap flex-1 text-left leading-none self-center"},[m(V,{text:e.item.name,query:e.searchQuery},null,8,["text","query"])]))]),_:1}),e.collapsed?(f(),v(G,{key:0,content:e.item.name,placement:"right",delay:300},null,8,["content"])):x("",!0)];I(l,m(p(e.item.icon),{class:[0===e.level?"h-5 w-5":1===e.level?"h-4 w-4":2===e.level?"h-3.5 w-3.5":"h-3 w-3","flex-shrink-0","self-center"]},null),r,n),l(""),e.collapsed?l("\x3c!----\x3e"):(l(`<span class="whitespace-nowrap flex-1 text-left leading-none self-center"${n}>`),l($(V,{text:e.item.name,query:e.searchQuery},null,r,n)),l("</span>")),e.collapsed?l($(G,{content:e.item.name,placement:"right",delay:300},null,r,n)):l("\x3c!----\x3e")}),_:1},l)),t("</div>")),t("</div>")}}),X=K.setup;K.setup=(e,t)=>{const l=y();return(l.modules||(l.modules=new Set)).add("components/ui/MenuItem.vue"),X?X(e,t):void 0};const Y=e({__name:"Sidebar",__ssrInlineRender:!0,props:{collapsed:{type:Boolean}},setup(e){const t=H(),{isInitialized:l}=z(),{getIconComponent:n}=Q(),{getMenus:a}=D(),s=o(""),u=o(""),m=o(""),p=o([]),v=c(()=>{if(console.log("Filtering navigation items:",{isInitialized:l.value,navigationItemsCount:p.value.length,searchQuery:u.value}),!l.value)return[];let e=p.value;if(u.value.trim()){const t=u.value.toLowerCase().trim(),removeDiacritics=e=>{let t=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t=t.replace(/[đĐ]/g,"d").replace(/[ăĂ]/g,"a").replace(/[âÂ]/g,"a").replace(/[êÊ]/g,"e").replace(/[ôÔ]/g,"o").replace(/[ơƠ]/g,"o").replace(/[ưƯ]/g,"u"),t},matchesQuery=(e,t)=>{const l=removeDiacritics(e).toLowerCase(),r=removeDiacritics(t).toLowerCase();return l.includes(r)};e=e.map(e=>{if(matchesQuery(e.name,t))return e;if(e.children){const l=e.children.filter(e=>!!matchesQuery(e.name,t)||!!e.children&&e.children.some(e=>matchesQuery(e.name,t)));if(l.length>0)return{...e,children:l}}return null}).filter(e=>null!==e)}return console.log("Filtered items result:",e.length,"items"),e}),loadMenus=async()=>{try{console.log("Loading menus from API...");const e=await a();console.log("Loaded menus:",e);const t=e.filter(e=>e.IsActive);console.log("Active menus:",t.length,"out of",e.length),console.log("Active menus data:",t);const buildNavigationTree=(e,t=null)=>{console.log("Building tree for parentId:",t,"with",e.length,"menus");const l=e.filter(e=>e.ParentId===t).sort((e,t)=>e.Order-t.Order);console.log("Filtered menus for parentId",t,":",l.length,"items");const r=l.map(t=>{console.log("Mapping menu:",t.Name,"ParentId:",t.ParentId,"Id:",t.Id);const l=buildNavigationTree(e,t.Id);return console.log(`Children for ${t.Name}:`,l.length,"items"),{name:t.Name,href:t.Href||"/",icon:n(t.Icon),children:l}});return console.log("Mapped items for parentId",t,":",r.length,"items"),r};p.value=buildNavigationTree(t),console.log("Navigation items built:",p.value),console.log("Navigation tree structure:",JSON.stringify(p.value,null,2))}catch(e){console.error("Error loading menus:",e),console.log("Using fallback menu data"),p.value=[{name:"Dashboard",href:"/main/dashboard",icon:n("LayoutDashboard")},{name:"Người dùng",href:"/admin/users",icon:n("Users")},{name:"Quản lý Menu",href:"/admin/menus",icon:n("Menu")},{name:"Đơn vị",href:"/admin/departments",icon:n("Building")},{name:"Hệ thống",href:"/system/settings",icon:n("Settings")}]}},f=o([]),toggleSubmenu=e=>{const t=f.value.indexOf(e);t>-1?f.value.splice(t,1):f.value.push(e)},isActive=e=>t.path===e,isSubmenuActive=e=>e.some(e=>e.children&&isSubmenuActive(e.children)||isActive(e.href));g(()=>t.path,()=>{loadMenus()},{immediate:!1});r("refreshSidebar",()=>{loadMenus()});let h=null;return g(u,e=>{h&&clearTimeout(h),h=setTimeout(()=>{m.value=e},150)}),g(u,e=>{if(e.trim()){const e=p.value.filter(e=>e.children&&e.children.length>0).map(e=>e.name);f.value=[...new Set([...f.value,...e])]}else f.value=[]}),(e,t,l,r)=>{t(`<aside${w(i({class:["fixed inset-y-0 left-0 z-50 bg-card border-r border-border transition-all duration-300 ease-in-out lg:translate-x-0 flex flex-col",e.collapsed?"w-16":"w-64"]},r))} data-v-eac7c815><div class="flex h-16 items-center justify-center border-b border-border" data-v-eac7c815>`),e.collapsed?t('<div class="w-8 h-8 rounded-lg bg-primary flex items-center justify-center" data-v-eac7c815><span class="text-primary-foreground font-bold text-sm" data-v-eac7c815>H</span></div>'):t('<div class="flex items-center space-x-2" data-v-eac7c815><div class="w-8 h-8 rounded-lg bg-primary flex items-center justify-center" data-v-eac7c815><span class="text-primary-foreground font-bold text-sm" data-v-eac7c815>H</span></div><span class="font-semibold text-foreground" data-v-eac7c815>HniDashOps</span></div>'),t("</div>"),e.collapsed?t("\x3c!----\x3e"):(t('<div class="px-4 pt-3 pb-1" data-v-eac7c815><div class="relative" data-v-eac7c815>'),t($(d(B),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"},null,l)),t(`<input${S("value",u.value)} type="text" placeholder="Tìm kiếm menu..." class="w-full pl-10 pr-4 py-2 text-sm bg-background border border-input rounded-md focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2" data-v-eac7c815>`),u.value?(t('<button class="absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground hover:text-foreground" data-v-eac7c815>'),t($(d(N),{class:"h-4 w-4"},null,l)),t("</button>")):t("\x3c!----\x3e"),t("</div></div>")),t(`<nav class="${_([e.collapsed?"px-2":"px-4","flex-1 pt-0 pb-6 space-y-1 transition-all duration-300"])}" data-v-eac7c815>\x3c!--[--\x3e`),j(v.value,r=>{t($(K,{key:r.name,item:r,level:0,collapsed:e.collapsed,"open-submenus":f.value,"toggle-submenu":toggleSubmenu,"is-active":isActive,"is-submenu-active":isSubmenuActive,"search-query":u.value},null,l))}),t('\x3c!--]--\x3e</nav><div class="border-t border-border p-4 mt-auto" data-v-eac7c815>'),e.collapsed?t('<div class="flex justify-center" data-v-eac7c815><div class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center" data-v-eac7c815><span class="text-xs font-bold text-primary" data-v-eac7c815>H</span></div></div>'):t(`<div class="text-center space-y-2" data-v-eac7c815><div class="text-xs text-muted-foreground" data-v-eac7c815>${C(s.value)}</div><div class="text-xs text-muted-foreground" data-v-eac7c815> © 2025 khuongnv </div></div>`),t("</div></aside>")}}}),ee=Y.setup;Y.setup=(e,t)=>{const l=y();return(l.modules||(l.modules=new Set)).add("components/Sidebar.vue"),ee?ee(e,t):void 0};const te=P(Y,[["__scopeId","data-v-eac7c815"]]),le=e({__name:"Header",__ssrInlineRender:!0,props:{collapsed:{type:Boolean}},emits:["toggle-sidebar"],setup(e){const t=O("color-mode").value,l=c(()=>"dark"===t.value);R(),z();const toggleColorMode=()=>{t.preference="dark"===t.value?"light":"dark"};return(e,t,r,n)=>{const a=Z;t(`<header${w(i({class:"sticky top-0 z-40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border"},n))}><div class="flex h-16 items-center justify-between px-6"><div class="flex items-center space-x-2">`),t($(U,{variant:"ghost",size:"sm",class:"h-18 w-18 p-0 hover:bg-accent/50 transition-colors",onClick:t=>e.$emit("toggle-sidebar")},{default:u((e,t,l,r)=>{if(!t)return[m(d(F),{class:"h-8 w-8"})];t($(d(F),{class:"h-8 w-8"},null,l,r))}),_:1},r)),t('<h1 class="text-lg font-semibold text-foreground">HỆ THỐNG QUẢN LÝ NHIỆM VỤ</h1></div><div class="flex items-center space-x-4">'),t($(U,{variant:"ghost",size:"sm",class:"h-9 w-9 p-0 hover:bg-accent/50 transition-colors",onClick:toggleColorMode},{default:u((e,t,r,n)=>{if(!t)return[(f(),v(p(d(l)?d(L):d(M)),{class:"h-4 w-4 transition-transform duration-200"}))];I(t,m(p(d(l)?d(L):d(M)),{class:"h-4 w-4 transition-transform duration-200"},null),r,n)}),_:1},r)),t($(a,null,{},r)),t("</div></div></header>")}}}),re=le.setup;le.setup=(e,t)=>{const l=y();return(l.modules||(l.modules=new Set)).add("components/Header.vue"),re?re(e,t):void 0};const ne=e({__name:"default",__ssrInlineRender:!0,setup(e){const t=o(!1),l=o(!1),toggleSidebar=()=>{t.value=!t.value};return(e,r,n,a)=>{const s=te,o=le;r(`<div${w(i({class:"min-h-screen bg-background"},a))}>`),!t.value&&l.value?r('<div class="fixed inset-0 z-40 bg-black/50 lg:hidden"></div>'):r("\x3c!----\x3e"),r($(s,{collapsed:t.value,class:{"translate-x-0":!t.value||!l.value,"-translate-x-full":t.value&&l.value}},null,n)),r(`<div class="${_([{"lg:pl-16":t.value,"lg:pl-64":!t.value},"flex flex-col min-h-screen transition-all duration-300 ease-in-out"])}">`),r($(o,{collapsed:t.value,onToggleSidebar:toggleSidebar},null,n)),r('<main class="flex-1 p-4 sm:p-6"><div class="h-full">'),k(e.$slots,"default",{},null,r,n),r("</div></main></div></div>")}}}),ae=ne.setup;ne.setup=(e,t)=>{const l=y();return(l.modules||(l.modules=new Set)).add("layouts/default.vue"),ae?ae(e,t):void 0};export{ne as default};
