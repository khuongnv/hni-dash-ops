import{defineComponent as e,ref as t,computed as a,mergeProps as l,withCtx as s,unref as n,createVNode as d,createTextVNode as r,createBlock as i,createCommentVNode as u,toDisplayString as c,openBlock as o,Fragment as f,renderList as m,useSSRContext as p}from"vue";import{ssrRenderAttrs as v,ssrRenderComponent as x,ssrRenderAttr as h,ssrIncludeBooleanAttr as g,ssrLooseContain as _,ssrLooseEqual as y,ssrInterpolate as b,ssrRenderList as k}from"vue/server-renderer";import{u as w}from"./useCategories-ig7z67MD.mjs";import{_ as C}from"./Button-C4ZWmsC_.mjs";import{_ as j,a as D,b as $,c as T}from"./CardContent-B5Mf_SVJ.mjs";import{_ as M}from"./CardDescription-DMlSm5A1.mjs";import{_ as z,a as A,b as I,c as N,d as L,e as E}from"./TableRow-ukuzC_Dy.mjs";import{_ as S}from"./Badge-DfRucjjx.mjs";import{_ as q}from"./Label-DTP1ztuh.mjs";import{_ as B}from"./PageHeader-B5d1DVEu.mjs";import{P as G,a as K}from"./plus-ZseF0iYE.mjs";import{R as H}from"./refresh-cw-Dq49VSBS.mjs";import{C as P}from"./chevron-right-Cq_K5LWB.mjs";import{T as R}from"./trash-2-Cb5c2PkA.mjs";import"./useErrorHandler-y_M1hPJN.mjs";import"./useAPI-Bps8bvAQ.mjs";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"unhead/plugins";import"vue-router";import"class-variance-authority";import"./utils-H80jjgLf.mjs";import"clsx";import"tailwind-merge";import"./nuxt-link-DTyZRdIe.mjs";import"./createLucideIcon-DpBqMQLu.mjs";const Q=e({__name:"categories",__ssrInlineRender:!0,setup(e){const{getCategories:p,deleteCategory:Q,getParentCategories:V}=w(),X=t([]),Z=t(!1),F=t(""),J=t("all"),W=t(new Set),Y=t(!1),O=t(!1),U=t(!1),ee=t(!1),te=t(!1),ae=t(null),le=t({id:null,code:"",name:"",parent_id:null,map_id:null,note:""}),hasChildren=e=>X.value.some(t=>t.parent_id===e),toggleCategoryCollapse=e=>{W.value.has(e)?W.value.delete(e):W.value.add(e)},isCategoryCollapsed=e=>W.value.has(e),isAnyParentCollapsed=e=>{if(!e.parent_id)return!1;const t=X.value.find(t=>t.id===e.parent_id);return!!t&&(!!isCategoryCollapsed(t.id)||isAnyParentCollapsed(t))},removeDiacritics=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D"),se=a(()=>{let e=X.value;if(F.value&&F.value.trim()){const t=F.value.toLowerCase().trim(),a=removeDiacritics(t),l=e.filter(e=>{const l=e.name.toLowerCase(),s=removeDiacritics(l),n=e.code.toLowerCase(),d=removeDiacritics(n);return l.includes(t)||s.includes(a)||n.includes(t)||d.includes(a)}),s=new Set;l.forEach(e=>{s.add(e.id);const t=(e=>{const t=[];let a=e.parent_id;for(;a;){const e=X.value.find(e=>e.id===a);if(!e)break;t.unshift(e),a=e.parent_id}return t})(e);t.forEach(e=>s.add(e.id))}),e=e.filter(e=>s.has(e.id))}return"root"===J.value?e=e.filter(e=>!e.parent_id):"child"===J.value&&(e=e.filter(e=>e.parent_id)),(e=>{const t=[],a=new Set,l=e.filter(e=>!e.parent_id).sort((e,t)=>e.id-t.id),addCategoryAndChildren=l=>{a.has(l.id)||isAnyParentCollapsed(l)||(t.push(l),a.add(l.id),isCategoryCollapsed(l.id))||e.filter(e=>e.parent_id===l.id).sort((e,t)=>e.id-t.id).forEach(e=>addCategoryAndChildren(e))};return l.forEach(e=>addCategoryAndChildren(e)),e.forEach(e=>{a.has(e.id)||isAnyParentCollapsed(e)||t.push(e)}),t})(e)}),ne=a(()=>U.value?V(X.value,le.value.id):V(X.value)),loadCategories=async()=>{Z.value=!0;try{X.value=await p()}catch(e){console.error("Error loading categories:",e)}finally{Z.value=!1}},getParentName=e=>{const t=X.value.find(t=>t.id===e);return t?`${t.name} (${t.code})`:"Không xác định"},getCategoryLevel=e=>{let t=1,a=e.parent_id;for(;a;){t++;const e=X.value.find(e=>e.id===a);if(!e)break;a=e.parent_id}return t},formatDate=e=>new Date(e).toLocaleDateString("vi-VN"),resetForm=()=>{le.value={id:null,code:"",name:"",parent_id:null,map_id:null,note:""}},openCreateModal=()=>{U.value=!1,resetForm(),Y.value=!0},openEditModal=e=>{U.value=!0,le.value={id:e.id,code:e.code,name:e.name,parent_id:e.parent_id,map_id:e.map_id,note:e.note||""},Y.value=!0},closeModal=()=>{Y.value=!1,resetForm()},confirmDelete=e=>{ae.value=e,O.value=!0},closeDeleteModal=()=>{O.value=!1,ae.value=null},deleteCategory=async()=>{if(ae.value){te.value=!0;try{await Q(ae.value.id),await loadCategories(),closeDeleteModal()}catch(e){console.error("Error deleting category:",e)}finally{te.value=!1}}};return(e,t,a,p)=>{var w;t(`<div${v(l({class:"h-full flex flex-col space-y-4"},p))}>`),t(x(B,{title:"Quản lý Danh mục",description:"Quản lý các danh mục sản phẩm và dịch vụ"},null,a)),t('<div class="flex items-center justify-between"><div class="flex items-center gap-3">'),t(x(C,{onClick:openCreateModal,class:"flex items-center gap-2"},{default:s((e,t,a,l)=>{if(!t)return[d(n(G),{class:"w-4 h-4"}),r(" Thêm danh mục mới ")];t(x(n(G),{class:"w-4 h-4"},null,a,l)),t(" Thêm danh mục mới ")}),_:1},a)),t(x(C,{variant:"outline",onClick:loadCategories,disabled:Z.value},{default:s((e,t,a,l)=>{if(!t)return[d(n(H),{class:["w-4 h-4",{"animate-spin":Z.value}]},null,8,["class"]),r(" Làm mới ")];t(x(n(H),{class:["w-4 h-4",{"animate-spin":Z.value}]},null,a,l)),t(" Làm mới ")}),_:1},a)),t(`</div><div class="flex items-center gap-2"><select class="w-40 h-10 px-3 py-2 text-sm border border-input bg-background rounded-md focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"><option value="all"${g(Array.isArray(J.value)?_(J.value,"all"):y(J.value,"all"))?" selected":""}>Tất cả</option><option value="root"${g(Array.isArray(J.value)?_(J.value,"root"):y(J.value,"root"))?" selected":""}>Danh mục gốc</option><option value="child"${g(Array.isArray(J.value)?_(J.value,"child"):y(J.value,"child"))?" selected":""}>Danh mục con</option></select><input${h("value",F.value)} placeholder="Tìm kiếm danh mục..." class="w-64 h-10 px-3 py-2 text-sm border border-input bg-background rounded-md focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"></div></div>`),t(x(j,{class:"-mt-2"},{default:s((e,t,a,l)=>{if(!t)return[d(D,null,{default:s(()=>[d($,null,{default:s(()=>[r("Danh sách Danh mục")]),_:1}),d(M,null,{default:s(()=>[r(" Tổng cộng "+c(se.value.length)+" danh mục ",1),F.value?(o(),i("span",{key:0,class:"text-blue-600"},' (Tìm kiếm: "'+c(F.value)+'") ',1)):u("",!0)]),_:1})]),_:1}),d(T,null,{default:s(()=>[d("div",{class:"rounded-md border"},[d(z,null,{default:s(()=>[d(A,null,{default:s(()=>[d(I,null,{default:s(()=>[d(N,{class:"w-12"},{default:s(()=>[r("#")]),_:1}),d(N,null,{default:s(()=>[r("Code")]),_:1}),d(N,null,{default:s(()=>[r("Tên danh mục")]),_:1}),d(N,null,{default:s(()=>[r("Danh mục cha")]),_:1}),d(N,null,{default:s(()=>[r("Cấp")]),_:1}),d(N,null,{default:s(()=>[r("Map ID")]),_:1}),d(N,null,{default:s(()=>[r("Ghi chú")]),_:1}),d(N,null,{default:s(()=>[r("Ngày tạo")]),_:1}),d(N,{class:"w-32"},{default:s(()=>[r("Thao tác")]),_:1})]),_:1})]),_:1}),d(L,null,{default:s(()=>[Z.value?(o(),i(I,{key:0},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8"},{default:s(()=>[d("div",{class:"flex items-center justify-center gap-2"},[d(n(H),{class:"w-4 h-4 animate-spin"}),r(" Đang tải... ")])]),_:1})]),_:1})):0===se.value.length?(o(),i(I,{key:1},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8 text-muted-foreground"},{default:s(()=>[r(" Không có danh mục nào ")]),_:1})]),_:1})):(o(!0),i(f,{key:2},m(se.value,e=>(o(),i(I,{key:e.id,class:"table-row-fixed"},{default:s(()=>[d(E,{class:"font-medium align-middle"},{default:s(()=>[r(c(e.id),1)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline"},{default:s(()=>[r(c(e.code),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},[(o(!0),i(f,null,m(getCategoryLevel(e)-1,t=>(o(),i("div",{key:t,class:"w-4 h-4 flex items-center justify-center"},[t===getCategoryLevel(e)-1?(o(),i("div",{key:0,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-4 h-4 border-l-2 border-b-2 border-muted-foreground/60 rounded-bl-sm"})])):(o(),i("div",{key:1,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-px h-3 bg-border"})]))]))),128))]),hasChildren(e.id)?(o(),i("button",{key:0,onClick:t=>toggleCategoryCollapse(e.id),class:"flex items-center justify-center w-4 h-4 rounded hover:bg-muted transition-colors cursor-pointer",title:isCategoryCollapsed(e.id)?"Mở rộng":"Thu gọn"},[d(n(P),{class:["w-3 h-3 transition-transform duration-200 text-muted-foreground",isCategoryCollapsed(e.id)?"rotate-0":"rotate-90"]},null,8,["class"])],8,["onClick","title"])):(o(),i("div",{key:1,class:"w-4 h-4"})),d("div",{class:"font-medium text-foreground"},c(e.name),1)])]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.parent_id?(o(),i("span",{key:0,class:"text-sm text-muted-foreground"},c(getParentName(e.parent_id)),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"Danh mục gốc"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline",class:"text-xs"},{default:s(()=>[r(" Cấp "+c(getCategoryLevel(e)),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.map_id?(o(),i("span",{key:0,class:"text-sm"},c(e.map_id),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.note?(o(),i("span",{key:0,class:"text-sm text-muted-foreground max-w-xs truncate"},c(e.note),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"text-sm text-muted-foreground"},{default:s(()=>[r(c(formatDate(e.created_at)),1)]),_:2},1024),d(E,null,{default:s(()=>[d("div",{class:"flex items-center gap-1"},[d(C,{variant:"ghost",size:"sm",onClick:t=>openEditModal(e)},{default:s(()=>[d(n(K),{class:"h-4 w-4"})]),_:1},8,["onClick"]),d(C,{variant:"ghost",size:"sm",onClick:t=>confirmDelete(e),disabled:hasChildren(e.id),class:"text-destructive hover:text-destructive"},{default:s(()=>[d(n(R),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),_:1})];t(x(D,null,{default:s((e,t,a,l)=>{if(!t)return[d($,null,{default:s(()=>[r("Danh sách Danh mục")]),_:1}),d(M,null,{default:s(()=>[r(" Tổng cộng "+c(se.value.length)+" danh mục ",1),F.value?(o(),i("span",{key:0,class:"text-blue-600"},' (Tìm kiếm: "'+c(F.value)+'") ',1)):u("",!0)]),_:1})];t(x($,null,{default:s((e,t,a,l)=>{if(!t)return[r("Danh sách Danh mục")];t("Danh sách Danh mục")}),_:1},a,l)),t(x(M,null,{default:s((e,t,a,l)=>{if(!t)return[r(" Tổng cộng "+c(se.value.length)+" danh mục ",1),F.value?(o(),i("span",{key:0,class:"text-blue-600"},' (Tìm kiếm: "'+c(F.value)+'") ',1)):u("",!0)];t(` Tổng cộng ${b(se.value.length)} danh mục `),F.value?t(`<span class="text-blue-600"${l}> (Tìm kiếm: &quot;${b(F.value)}&quot;) </span>`):t("\x3c!----\x3e")}),_:1},a,l))}),_:1},a,l)),t(x(T,null,{default:s((e,t,a,l)=>{if(!t)return[d("div",{class:"rounded-md border"},[d(z,null,{default:s(()=>[d(A,null,{default:s(()=>[d(I,null,{default:s(()=>[d(N,{class:"w-12"},{default:s(()=>[r("#")]),_:1}),d(N,null,{default:s(()=>[r("Code")]),_:1}),d(N,null,{default:s(()=>[r("Tên danh mục")]),_:1}),d(N,null,{default:s(()=>[r("Danh mục cha")]),_:1}),d(N,null,{default:s(()=>[r("Cấp")]),_:1}),d(N,null,{default:s(()=>[r("Map ID")]),_:1}),d(N,null,{default:s(()=>[r("Ghi chú")]),_:1}),d(N,null,{default:s(()=>[r("Ngày tạo")]),_:1}),d(N,{class:"w-32"},{default:s(()=>[r("Thao tác")]),_:1})]),_:1})]),_:1}),d(L,null,{default:s(()=>[Z.value?(o(),i(I,{key:0},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8"},{default:s(()=>[d("div",{class:"flex items-center justify-center gap-2"},[d(n(H),{class:"w-4 h-4 animate-spin"}),r(" Đang tải... ")])]),_:1})]),_:1})):0===se.value.length?(o(),i(I,{key:1},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8 text-muted-foreground"},{default:s(()=>[r(" Không có danh mục nào ")]),_:1})]),_:1})):(o(!0),i(f,{key:2},m(se.value,e=>(o(),i(I,{key:e.id,class:"table-row-fixed"},{default:s(()=>[d(E,{class:"font-medium align-middle"},{default:s(()=>[r(c(e.id),1)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline"},{default:s(()=>[r(c(e.code),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},[(o(!0),i(f,null,m(getCategoryLevel(e)-1,t=>(o(),i("div",{key:t,class:"w-4 h-4 flex items-center justify-center"},[t===getCategoryLevel(e)-1?(o(),i("div",{key:0,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-4 h-4 border-l-2 border-b-2 border-muted-foreground/60 rounded-bl-sm"})])):(o(),i("div",{key:1,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-px h-3 bg-border"})]))]))),128))]),hasChildren(e.id)?(o(),i("button",{key:0,onClick:t=>toggleCategoryCollapse(e.id),class:"flex items-center justify-center w-4 h-4 rounded hover:bg-muted transition-colors cursor-pointer",title:isCategoryCollapsed(e.id)?"Mở rộng":"Thu gọn"},[d(n(P),{class:["w-3 h-3 transition-transform duration-200 text-muted-foreground",isCategoryCollapsed(e.id)?"rotate-0":"rotate-90"]},null,8,["class"])],8,["onClick","title"])):(o(),i("div",{key:1,class:"w-4 h-4"})),d("div",{class:"font-medium text-foreground"},c(e.name),1)])]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.parent_id?(o(),i("span",{key:0,class:"text-sm text-muted-foreground"},c(getParentName(e.parent_id)),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"Danh mục gốc"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline",class:"text-xs"},{default:s(()=>[r(" Cấp "+c(getCategoryLevel(e)),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.map_id?(o(),i("span",{key:0,class:"text-sm"},c(e.map_id),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.note?(o(),i("span",{key:0,class:"text-sm text-muted-foreground max-w-xs truncate"},c(e.note),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"text-sm text-muted-foreground"},{default:s(()=>[r(c(formatDate(e.created_at)),1)]),_:2},1024),d(E,null,{default:s(()=>[d("div",{class:"flex items-center gap-1"},[d(C,{variant:"ghost",size:"sm",onClick:t=>openEditModal(e)},{default:s(()=>[d(n(K),{class:"h-4 w-4"})]),_:1},8,["onClick"]),d(C,{variant:"ghost",size:"sm",onClick:t=>confirmDelete(e),disabled:hasChildren(e.id),class:"text-destructive hover:text-destructive"},{default:s(()=>[d(n(R),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])];t(`<div class="rounded-md border"${l}>`),t(x(z,null,{default:s((e,t,a,l)=>{if(!t)return[d(A,null,{default:s(()=>[d(I,null,{default:s(()=>[d(N,{class:"w-12"},{default:s(()=>[r("#")]),_:1}),d(N,null,{default:s(()=>[r("Code")]),_:1}),d(N,null,{default:s(()=>[r("Tên danh mục")]),_:1}),d(N,null,{default:s(()=>[r("Danh mục cha")]),_:1}),d(N,null,{default:s(()=>[r("Cấp")]),_:1}),d(N,null,{default:s(()=>[r("Map ID")]),_:1}),d(N,null,{default:s(()=>[r("Ghi chú")]),_:1}),d(N,null,{default:s(()=>[r("Ngày tạo")]),_:1}),d(N,{class:"w-32"},{default:s(()=>[r("Thao tác")]),_:1})]),_:1})]),_:1}),d(L,null,{default:s(()=>[Z.value?(o(),i(I,{key:0},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8"},{default:s(()=>[d("div",{class:"flex items-center justify-center gap-2"},[d(n(H),{class:"w-4 h-4 animate-spin"}),r(" Đang tải... ")])]),_:1})]),_:1})):0===se.value.length?(o(),i(I,{key:1},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8 text-muted-foreground"},{default:s(()=>[r(" Không có danh mục nào ")]),_:1})]),_:1})):(o(!0),i(f,{key:2},m(se.value,e=>(o(),i(I,{key:e.id,class:"table-row-fixed"},{default:s(()=>[d(E,{class:"font-medium align-middle"},{default:s(()=>[r(c(e.id),1)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline"},{default:s(()=>[r(c(e.code),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},[(o(!0),i(f,null,m(getCategoryLevel(e)-1,t=>(o(),i("div",{key:t,class:"w-4 h-4 flex items-center justify-center"},[t===getCategoryLevel(e)-1?(o(),i("div",{key:0,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-4 h-4 border-l-2 border-b-2 border-muted-foreground/60 rounded-bl-sm"})])):(o(),i("div",{key:1,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-px h-3 bg-border"})]))]))),128))]),hasChildren(e.id)?(o(),i("button",{key:0,onClick:t=>toggleCategoryCollapse(e.id),class:"flex items-center justify-center w-4 h-4 rounded hover:bg-muted transition-colors cursor-pointer",title:isCategoryCollapsed(e.id)?"Mở rộng":"Thu gọn"},[d(n(P),{class:["w-3 h-3 transition-transform duration-200 text-muted-foreground",isCategoryCollapsed(e.id)?"rotate-0":"rotate-90"]},null,8,["class"])],8,["onClick","title"])):(o(),i("div",{key:1,class:"w-4 h-4"})),d("div",{class:"font-medium text-foreground"},c(e.name),1)])]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.parent_id?(o(),i("span",{key:0,class:"text-sm text-muted-foreground"},c(getParentName(e.parent_id)),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"Danh mục gốc"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline",class:"text-xs"},{default:s(()=>[r(" Cấp "+c(getCategoryLevel(e)),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.map_id?(o(),i("span",{key:0,class:"text-sm"},c(e.map_id),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.note?(o(),i("span",{key:0,class:"text-sm text-muted-foreground max-w-xs truncate"},c(e.note),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"text-sm text-muted-foreground"},{default:s(()=>[r(c(formatDate(e.created_at)),1)]),_:2},1024),d(E,null,{default:s(()=>[d("div",{class:"flex items-center gap-1"},[d(C,{variant:"ghost",size:"sm",onClick:t=>openEditModal(e)},{default:s(()=>[d(n(K),{class:"h-4 w-4"})]),_:1},8,["onClick"]),d(C,{variant:"ghost",size:"sm",onClick:t=>confirmDelete(e),disabled:hasChildren(e.id),class:"text-destructive hover:text-destructive"},{default:s(()=>[d(n(R),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})];t(x(A,null,{default:s((e,t,a,l)=>{if(!t)return[d(I,null,{default:s(()=>[d(N,{class:"w-12"},{default:s(()=>[r("#")]),_:1}),d(N,null,{default:s(()=>[r("Code")]),_:1}),d(N,null,{default:s(()=>[r("Tên danh mục")]),_:1}),d(N,null,{default:s(()=>[r("Danh mục cha")]),_:1}),d(N,null,{default:s(()=>[r("Cấp")]),_:1}),d(N,null,{default:s(()=>[r("Map ID")]),_:1}),d(N,null,{default:s(()=>[r("Ghi chú")]),_:1}),d(N,null,{default:s(()=>[r("Ngày tạo")]),_:1}),d(N,{class:"w-32"},{default:s(()=>[r("Thao tác")]),_:1})]),_:1})];t(x(I,null,{default:s((e,t,a,l)=>{if(!t)return[d(N,{class:"w-12"},{default:s(()=>[r("#")]),_:1}),d(N,null,{default:s(()=>[r("Code")]),_:1}),d(N,null,{default:s(()=>[r("Tên danh mục")]),_:1}),d(N,null,{default:s(()=>[r("Danh mục cha")]),_:1}),d(N,null,{default:s(()=>[r("Cấp")]),_:1}),d(N,null,{default:s(()=>[r("Map ID")]),_:1}),d(N,null,{default:s(()=>[r("Ghi chú")]),_:1}),d(N,null,{default:s(()=>[r("Ngày tạo")]),_:1}),d(N,{class:"w-32"},{default:s(()=>[r("Thao tác")]),_:1})];t(x(N,{class:"w-12"},{default:s((e,t,a,l)=>{if(!t)return[r("#")];t("#")}),_:1},a,l)),t(x(N,null,{default:s((e,t,a,l)=>{if(!t)return[r("Code")];t("Code")}),_:1},a,l)),t(x(N,null,{default:s((e,t,a,l)=>{if(!t)return[r("Tên danh mục")];t("Tên danh mục")}),_:1},a,l)),t(x(N,null,{default:s((e,t,a,l)=>{if(!t)return[r("Danh mục cha")];t("Danh mục cha")}),_:1},a,l)),t(x(N,null,{default:s((e,t,a,l)=>{if(!t)return[r("Cấp")];t("Cấp")}),_:1},a,l)),t(x(N,null,{default:s((e,t,a,l)=>{if(!t)return[r("Map ID")];t("Map ID")}),_:1},a,l)),t(x(N,null,{default:s((e,t,a,l)=>{if(!t)return[r("Ghi chú")];t("Ghi chú")}),_:1},a,l)),t(x(N,null,{default:s((e,t,a,l)=>{if(!t)return[r("Ngày tạo")];t("Ngày tạo")}),_:1},a,l)),t(x(N,{class:"w-32"},{default:s((e,t,a,l)=>{if(!t)return[r("Thao tác")];t("Thao tác")}),_:1},a,l))}),_:1},a,l))}),_:1},a,l)),t(x(L,null,{default:s((e,t,a,l)=>{if(!t)return[Z.value?(o(),i(I,{key:0},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8"},{default:s(()=>[d("div",{class:"flex items-center justify-center gap-2"},[d(n(H),{class:"w-4 h-4 animate-spin"}),r(" Đang tải... ")])]),_:1})]),_:1})):0===se.value.length?(o(),i(I,{key:1},{default:s(()=>[d(E,{colspan:"9",class:"text-center py-8 text-muted-foreground"},{default:s(()=>[r(" Không có danh mục nào ")]),_:1})]),_:1})):(o(!0),i(f,{key:2},m(se.value,e=>(o(),i(I,{key:e.id,class:"table-row-fixed"},{default:s(()=>[d(E,{class:"font-medium align-middle"},{default:s(()=>[r(c(e.id),1)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline"},{default:s(()=>[r(c(e.code),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},[(o(!0),i(f,null,m(getCategoryLevel(e)-1,t=>(o(),i("div",{key:t,class:"w-4 h-4 flex items-center justify-center"},[t===getCategoryLevel(e)-1?(o(),i("div",{key:0,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-4 h-4 border-l-2 border-b-2 border-muted-foreground/60 rounded-bl-sm"})])):(o(),i("div",{key:1,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-px h-3 bg-border"})]))]))),128))]),hasChildren(e.id)?(o(),i("button",{key:0,onClick:t=>toggleCategoryCollapse(e.id),class:"flex items-center justify-center w-4 h-4 rounded hover:bg-muted transition-colors cursor-pointer",title:isCategoryCollapsed(e.id)?"Mở rộng":"Thu gọn"},[d(n(P),{class:["w-3 h-3 transition-transform duration-200 text-muted-foreground",isCategoryCollapsed(e.id)?"rotate-0":"rotate-90"]},null,8,["class"])],8,["onClick","title"])):(o(),i("div",{key:1,class:"w-4 h-4"})),d("div",{class:"font-medium text-foreground"},c(e.name),1)])]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.parent_id?(o(),i("span",{key:0,class:"text-sm text-muted-foreground"},c(getParentName(e.parent_id)),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"Danh mục gốc"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline",class:"text-xs"},{default:s(()=>[r(" Cấp "+c(getCategoryLevel(e)),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.map_id?(o(),i("span",{key:0,class:"text-sm"},c(e.map_id),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.note?(o(),i("span",{key:0,class:"text-sm text-muted-foreground max-w-xs truncate"},c(e.note),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"text-sm text-muted-foreground"},{default:s(()=>[r(c(formatDate(e.created_at)),1)]),_:2},1024),d(E,null,{default:s(()=>[d("div",{class:"flex items-center gap-1"},[d(C,{variant:"ghost",size:"sm",onClick:t=>openEditModal(e)},{default:s(()=>[d(n(K),{class:"h-4 w-4"})]),_:1},8,["onClick"]),d(C,{variant:"ghost",size:"sm",onClick:t=>confirmDelete(e),disabled:hasChildren(e.id),class:"text-destructive hover:text-destructive"},{default:s(()=>[d(n(R),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])]),_:2},1024)]),_:2},1024))),128))];Z.value?t(x(I,null,{default:s((e,t,a,l)=>{if(!t)return[d(E,{colspan:"9",class:"text-center py-8"},{default:s(()=>[d("div",{class:"flex items-center justify-center gap-2"},[d(n(H),{class:"w-4 h-4 animate-spin"}),r(" Đang tải... ")])]),_:1})];t(x(E,{colspan:"9",class:"text-center py-8"},{default:s((e,t,a,l)=>{if(!t)return[d("div",{class:"flex items-center justify-center gap-2"},[d(n(H),{class:"w-4 h-4 animate-spin"}),r(" Đang tải... ")])];t(`<div class="flex items-center justify-center gap-2"${l}>`),t(x(n(H),{class:"w-4 h-4 animate-spin"},null,a,l)),t(" Đang tải... </div>")}),_:1},a,l))}),_:1},a,l)):0===se.value.length?t(x(I,null,{default:s((e,t,a,l)=>{if(!t)return[d(E,{colspan:"9",class:"text-center py-8 text-muted-foreground"},{default:s(()=>[r(" Không có danh mục nào ")]),_:1})];t(x(E,{colspan:"9",class:"text-center py-8 text-muted-foreground"},{default:s((e,t,a,l)=>{if(!t)return[r(" Không có danh mục nào ")];t(" Không có danh mục nào ")}),_:1},a,l))}),_:1},a,l)):(t("\x3c!--[--\x3e"),k(se.value,e=>{t(x(I,{key:e.id,class:"table-row-fixed"},{default:s((t,a,l,u)=>{if(!a)return[d(E,{class:"font-medium align-middle"},{default:s(()=>[r(c(e.id),1)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline"},{default:s(()=>[r(c(e.code),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},[(o(!0),i(f,null,m(getCategoryLevel(e)-1,t=>(o(),i("div",{key:t,class:"w-4 h-4 flex items-center justify-center"},[t===getCategoryLevel(e)-1?(o(),i("div",{key:0,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-4 h-4 border-l-2 border-b-2 border-muted-foreground/60 rounded-bl-sm"})])):(o(),i("div",{key:1,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-px h-3 bg-border"})]))]))),128))]),hasChildren(e.id)?(o(),i("button",{key:0,onClick:t=>toggleCategoryCollapse(e.id),class:"flex items-center justify-center w-4 h-4 rounded hover:bg-muted transition-colors cursor-pointer",title:isCategoryCollapsed(e.id)?"Mở rộng":"Thu gọn"},[d(n(P),{class:["w-3 h-3 transition-transform duration-200 text-muted-foreground",isCategoryCollapsed(e.id)?"rotate-0":"rotate-90"]},null,8,["class"])],8,["onClick","title"])):(o(),i("div",{key:1,class:"w-4 h-4"})),d("div",{class:"font-medium text-foreground"},c(e.name),1)])]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.parent_id?(o(),i("span",{key:0,class:"text-sm text-muted-foreground"},c(getParentName(e.parent_id)),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"Danh mục gốc"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[d(S,{variant:"outline",class:"text-xs"},{default:s(()=>[r(" Cấp "+c(getCategoryLevel(e)),1)]),_:2},1024)]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.map_id?(o(),i("span",{key:0,class:"text-sm"},c(e.map_id),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"align-middle"},{default:s(()=>[e.note?(o(),i("span",{key:0,class:"text-sm text-muted-foreground max-w-xs truncate"},c(e.note),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))]),_:2},1024),d(E,{class:"text-sm text-muted-foreground"},{default:s(()=>[r(c(formatDate(e.created_at)),1)]),_:2},1024),d(E,null,{default:s(()=>[d("div",{class:"flex items-center gap-1"},[d(C,{variant:"ghost",size:"sm",onClick:t=>openEditModal(e)},{default:s(()=>[d(n(K),{class:"h-4 w-4"})]),_:1},8,["onClick"]),d(C,{variant:"ghost",size:"sm",onClick:t=>confirmDelete(e),disabled:hasChildren(e.id),class:"text-destructive hover:text-destructive"},{default:s(()=>[d(n(R),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])]),_:2},1024)];a(x(E,{class:"font-medium align-middle"},{default:s((t,a,l,s)=>{if(!a)return[r(c(e.id),1)];a(`${b(e.id)}`)}),_:2},l,u)),a(x(E,{class:"align-middle"},{default:s((t,a,l,n)=>{if(!a)return[d(S,{variant:"outline"},{default:s(()=>[r(c(e.code),1)]),_:2},1024)];a(x(S,{variant:"outline"},{default:s((t,a,l,s)=>{if(!a)return[r(c(e.code),1)];a(`${b(e.code)}`)}),_:2},l,n))}),_:2},l,u)),a(x(E,{class:"align-middle"},{default:s((t,a,l,s)=>{if(!a)return[d("div",{class:"flex items-center gap-2"},[d("div",{class:"flex items-center"},[(o(!0),i(f,null,m(getCategoryLevel(e)-1,t=>(o(),i("div",{key:t,class:"w-4 h-4 flex items-center justify-center"},[t===getCategoryLevel(e)-1?(o(),i("div",{key:0,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-4 h-4 border-l-2 border-b-2 border-muted-foreground/60 rounded-bl-sm"})])):(o(),i("div",{key:1,class:"w-3 h-3 flex items-center justify-center"},[d("div",{class:"w-px h-3 bg-border"})]))]))),128))]),hasChildren(e.id)?(o(),i("button",{key:0,onClick:t=>toggleCategoryCollapse(e.id),class:"flex items-center justify-center w-4 h-4 rounded hover:bg-muted transition-colors cursor-pointer",title:isCategoryCollapsed(e.id)?"Mở rộng":"Thu gọn"},[d(n(P),{class:["w-3 h-3 transition-transform duration-200 text-muted-foreground",isCategoryCollapsed(e.id)?"rotate-0":"rotate-90"]},null,8,["class"])],8,["onClick","title"])):(o(),i("div",{key:1,class:"w-4 h-4"})),d("div",{class:"font-medium text-foreground"},c(e.name),1)])];a(`<div class="flex items-center gap-2"${s}><div class="flex items-center"${s}>\x3c!--[--\x3e`),k(getCategoryLevel(e)-1,t=>{a(`<div class="w-4 h-4 flex items-center justify-center"${s}>`),t===getCategoryLevel(e)-1?a(`<div class="w-3 h-3 flex items-center justify-center"${s}><div class="w-4 h-4 border-l-2 border-b-2 border-muted-foreground/60 rounded-bl-sm"${s}></div></div>`):a(`<div class="w-3 h-3 flex items-center justify-center"${s}><div class="w-px h-3 bg-border"${s}></div></div>`),a("</div>")}),a("\x3c!--]--\x3e</div>"),hasChildren(e.id)?(a(`<button class="flex items-center justify-center w-4 h-4 rounded hover:bg-muted transition-colors cursor-pointer"${h("title",isCategoryCollapsed(e.id)?"Mở rộng":"Thu gọn")}${s}>`),a(x(n(P),{class:["w-3 h-3 transition-transform duration-200 text-muted-foreground",isCategoryCollapsed(e.id)?"rotate-0":"rotate-90"]},null,l,s)),a("</button>")):a(`<div class="w-4 h-4"${s}></div>`),a(`<div class="font-medium text-foreground"${s}>${b(e.name)}</div></div>`)}),_:2},l,u)),a(x(E,{class:"align-middle"},{default:s((t,a,l,s)=>{if(!a)return[e.parent_id?(o(),i("span",{key:0,class:"text-sm text-muted-foreground"},c(getParentName(e.parent_id)),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"Danh mục gốc"))];e.parent_id?a(`<span class="text-sm text-muted-foreground"${s}>${b(getParentName(e.parent_id))}</span>`):a(`<span class="text-sm text-muted-foreground"${s}>Danh mục gốc</span>`)}),_:2},l,u)),a(x(E,{class:"align-middle"},{default:s((t,a,l,n)=>{if(!a)return[d(S,{variant:"outline",class:"text-xs"},{default:s(()=>[r(" Cấp "+c(getCategoryLevel(e)),1)]),_:2},1024)];a(x(S,{variant:"outline",class:"text-xs"},{default:s((t,a,l,s)=>{if(!a)return[r(" Cấp "+c(getCategoryLevel(e)),1)];a(` Cấp ${b(getCategoryLevel(e))}`)}),_:2},l,n))}),_:2},l,u)),a(x(E,{class:"align-middle"},{default:s((t,a,l,s)=>{if(!a)return[e.map_id?(o(),i("span",{key:0,class:"text-sm"},c(e.map_id),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))];e.map_id?a(`<span class="text-sm"${s}>${b(e.map_id)}</span>`):a(`<span class="text-sm text-muted-foreground"${s}>-</span>`)}),_:2},l,u)),a(x(E,{class:"align-middle"},{default:s((t,a,l,s)=>{if(!a)return[e.note?(o(),i("span",{key:0,class:"text-sm text-muted-foreground max-w-xs truncate"},c(e.note),1)):(o(),i("span",{key:1,class:"text-sm text-muted-foreground"},"-"))];e.note?a(`<span class="text-sm text-muted-foreground max-w-xs truncate"${s}>${b(e.note)}</span>`):a(`<span class="text-sm text-muted-foreground"${s}>-</span>`)}),_:2},l,u)),a(x(E,{class:"text-sm text-muted-foreground"},{default:s((t,a,l,s)=>{if(!a)return[r(c(formatDate(e.created_at)),1)];a(`${b(formatDate(e.created_at))}`)}),_:2},l,u)),a(x(E,null,{default:s((t,a,l,r)=>{if(!a)return[d("div",{class:"flex items-center gap-1"},[d(C,{variant:"ghost",size:"sm",onClick:t=>openEditModal(e)},{default:s(()=>[d(n(K),{class:"h-4 w-4"})]),_:1},8,["onClick"]),d(C,{variant:"ghost",size:"sm",onClick:t=>confirmDelete(e),disabled:hasChildren(e.id),class:"text-destructive hover:text-destructive"},{default:s(()=>[d(n(R),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])];a(`<div class="flex items-center gap-1"${r}>`),a(x(C,{variant:"ghost",size:"sm",onClick:t=>openEditModal(e)},{default:s((e,t,a,l)=>{if(!t)return[d(n(K),{class:"h-4 w-4"})];t(x(n(K),{class:"h-4 w-4"},null,a,l))}),_:2},l,r)),a(x(C,{variant:"ghost",size:"sm",onClick:t=>confirmDelete(e),disabled:hasChildren(e.id),class:"text-destructive hover:text-destructive"},{default:s((e,t,a,l)=>{if(!t)return[d(n(R),{class:"h-4 w-4"})];t(x(n(R),{class:"h-4 w-4"},null,a,l))}),_:2},l,r)),a("</div>")}),_:2},l,u))}),_:2},a,l))}),t("\x3c!--]--\x3e"))}),_:1},a,l))}),_:1},a,l)),t("</div>")}),_:1},a,l))}),_:1},a)),Y.value?(t(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg p-6 w-full max-w-md mx-4"><h3 class="text-lg font-semibold mb-4">${b(U.value?"Sửa danh mục":"Thêm danh mục mới")}</h3><form class="space-y-4"><div>`),t(x(q,{for:"code"},{default:s((e,t,a,l)=>{if(!t)return[r("Code *")];t("Code *")}),_:1},a)),t(`<input id="code"${h("value",le.value.code)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nhập code danh mục"></div><div>`),t(x(q,{for:"name"},{default:s((e,t,a,l)=>{if(!t)return[r("Tên danh mục *")];t("Tên danh mục *")}),_:1},a)),t(`<input id="name"${h("value",le.value.name)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nhập tên danh mục"></div><div>`),t(x(q,{for:"parent_id"},{default:s((e,t,a,l)=>{if(!t)return[r("Danh mục cha")];t("Danh mục cha")}),_:1},a)),t(`<select id="parent_id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option value=""${g(Array.isArray(le.value.parent_id)?_(le.value.parent_id,""):y(le.value.parent_id,""))?" selected":""}>Chọn danh mục cha (tùy chọn)</option>\x3c!--[--\x3e`),k(ne.value,e=>{t(`<option${h("value",e.id)}${g(Array.isArray(le.value.parent_id)?_(le.value.parent_id,e.id):y(le.value.parent_id,e.id))?" selected":""}>${b(e.name)} (${b(e.code)}) </option>`)}),t("\x3c!--]--\x3e</select></div><div>"),t(x(q,{for:"map_id"},{default:s((e,t,a,l)=>{if(!t)return[r("Map ID")];t("Map ID")}),_:1},a)),t(`<input id="map_id"${h("value",le.value.map_id)} type="number" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nhập Map ID (tùy chọn)"></div><div>`),t(x(q,{for:"note"},{default:s((e,t,a,l)=>{if(!t)return[r("Ghi chú")];t("Ghi chú")}),_:1},a)),t(`<textarea id="note" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nhập ghi chú (tùy chọn)">${b(le.value.note)}</textarea></div><div class="flex gap-3 pt-4">`),t(x(C,{type:"button",variant:"outline",onClick:closeModal,class:"flex-1"},{default:s((e,t,a,l)=>{if(!t)return[r(" Hủy ")];t(" Hủy ")}),_:1},a)),t(x(C,{type:"submit",disabled:ee.value,class:"flex-1"},{default:s((e,t,a,l)=>{if(!t)return[r(c(ee.value?"Đang xử lý...":U.value?"Cập nhật":"Tạo mới"),1)];t(`${b(ee.value?"Đang xử lý...":U.value?"Cập nhật":"Tạo mới")}`)}),_:1},a)),t("</div></form></div></div>")):t("\x3c!----\x3e"),O.value?(t(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg p-6 w-full max-w-md mx-4"><h3 class="text-lg font-semibold mb-4 text-red-600">Xác nhận xóa</h3><p class="text-gray-600 mb-6"> Bạn có chắc chắn muốn xóa danh mục <strong>&quot;${b(null==(w=ae.value)?void 0:w.name)}&quot;</strong>? <br><span class="text-sm text-red-500">Hành động này không thể hoàn tác.</span></p><div class="flex gap-3">`),t(x(C,{variant:"outline",onClick:closeDeleteModal,class:"flex-1"},{default:s((e,t,a,l)=>{if(!t)return[r(" Hủy ")];t(" Hủy ")}),_:1},a)),t(x(C,{variant:"destructive",onClick:deleteCategory,disabled:te.value,class:"flex-1"},{default:s((e,t,a,l)=>{if(!t)return[r(c(te.value?"Đang xóa...":"Xóa"),1)];t(`${b(te.value?"Đang xóa...":"Xóa")}`)}),_:1},a)),t("</div></div></div>")):t("\x3c!----\x3e"),t("</div>")}}}),V=Q.setup;Q.setup=(e,t)=>{const a=p();return(a.modules||(a.modules=new Set)).add("pages/admin/categories.vue"),V?V(e,t):void 0};export{Q as default};
